# 技術選定

## ドキュメント参照

このドキュメントは以下のドキュメントと密接に関連しています：

- [要件定義.md](./要件定義.md): 実装すべき機能要件の定義
- [API仕様.md](./API仕様.md): バックエンドAPIの詳細仕様
- [DB設計.md](./DB設計.md): データベーススキーマの設計
- [SDK設計.md](./SDK設計.md): AI開発用SDKの設計
- [ディレクトリ構成.md](./ディレクトリ構成.md): プロジェクトのディレクトリ構造

## 技術スタック概要

このプロジェクトでは、以下の技術スタックを採用しています：

1. フロントエンド: Next.js + React + TypeScript
2. バックエンド: Node.js (Express)
3. データベース: PlanetScale (MySQL)
4. AI実行環境: Docker + Python
5. デプロイ: Vercel

各技術の選定理由と実装詳細は以下のセクションで説明します。

## 1. フロントエンド

### フレームワーク
- **Next.js 14.1.3**
  - App Routerを採用し、実装済み
  - サーバーコンポーネントとクライアントコンポーネントの分離を実装
  - ファイルベースのルーティングを実装
  - ビルド時の最適化を適用
  - TypeScriptのサポートを活用

### 言語
- **TypeScript**
  - 型安全性を確保し、実装済み
  - 開発効率の向上を実現
  - コードの保守性を向上

### スタイリング
- **Tailwind CSS**
  - ユーティリティファーストのアプローチを採用
  - カスタムテーマを実装（ダークモード対応）
  - レスポンシブデザインを実装
  - アニメーション（tailwindcss-animate）を実装

### 状態管理
- **Zustand**
  - 軽量でシンプルな状態管理を実装
  - TypeScriptとの相性を活かした型安全な実装
  - ミドルウェアのサポート（devtools）を実装
  - 複数ゲームセッションの管理を実現

### UIコンポーネント
- **shadcn/ui**（Radix UIベース）
  - アクセシブルなコンポーネントを実装
  - スタイリングの柔軟性を活用
  - キーボード操作のサポートを実装
  - 以下のコンポーネントを実装済み：
    - Button
    - Card
    - Progress

### アニメーション
- **tailwindcss-animate**
  - Tailwind CSSと統合されたアニメーションを実装
  - パフォーマンスの最適化を適用
  - カスタマイズ可能なアニメーションを実装

### 開発ツール
- **ESLint**
  - コード品質の維持を実装
  - TypeScriptのサポートを活用
- **PostCSS**
  - CSSの最適化を実装
  - Tailwind CSSの処理を設定

### 実装済みの主要機能
1. **ゲーム画面**
   - Canvasを使用した迷路描画
   - プレイヤーの位置表示と移動
   - ターン制の実装
   - 移動・攻撃コントロール
   - ゲーム状態の表示

2. **UI/UX**
   - レスポンシブデザイン
   - ダークモード対応
   - アニメーション効果
   - アクセシブルなコンポーネント

3. **ルーティング**
   - 動的ルーティングによるゲームセッション管理
   - レイアウトの共有
   - クライアントサイドナビゲーション

4. **状態管理**
   - 複数ゲームセッションのサポート
   - 型安全な状態更新
   - リアルタイムな状態同期

## 2. バックエンド

* **技術**: Node.js（Express）
* **理由**: REST APIの開発に適しており、軽量で扱いやすい。JavaScriptの統一により開発効率向上

---

## 3. AI操作API

* **形式**: REST API

  * `GET`: 現在の迷路・プレイヤー状態取得
  * `POST`: プレイヤーのコマンド送信
* **AI実装言語**: Python（ユーザーが学習しやすく、ライブラリも豊富）
* **AI実行環境**: Dockerコンテナによる分離実行

---

## 4. ゲームロジック・描画

* **クライアント側**に迷路・プレイヤーの描画ロジック（Canvas）を実装
* **ターン進行**はサーバーが制御し、状態をフロントに返却

---

## 5. データベース

* **選定DB**: PlanetScale（MySQL互換）
* **理由**:

  * Vercelと公式に連携されており、CI/CDに組み込みやすい
  * サーバーレスMySQL（Vitessベース）で自動スケーリング対応
  * Gitのようなスキーマ管理が可能で安全
* **無料枠**:

  * 最大5GBストレージ
  * 月間1億行の読み取り、1000万行の書き込み
* **使用目的**: スコア・ログの保存、ユーザー管理、ゲーム進行記録など

---

## 6. AI実行環境

* **技術**: Docker
* **構成**:

  * 軽量PythonベースのAIコンテナをサーバーから起動・制御
  * 外部との通信はREST APIを介して行う
* **セキュリティ**: 分離環境によりシステム本体に影響しない安全な実行

---

## 7. デプロイ・提出

* **推奨ホスティング**: Vercel（Next.jsとの親和性が高い）
* **代替案**: Railway / Render（Express/FastAPIなどのバックエンドも対応可能）
* **構成管理**: `docker-compose` による一括起動・管理をサポート

---

## 8. 記録機能

* スコア・ログはPlanetScale（MySQL）に保存
* **可視化**: Chart.js または Recharts を用いたグラフ表示を実装予定

---

## 9. その他

* **提出形式**: WebアプリとしてURLで公開可能な形で提出
* **備考**: 学習済みAIは、ファイルアップロードまたはWeb API経由で呼び出す想定
* **開発体制**: 分業しやすいディレクトリ構成により、フロント・バックエンド・AI開発を並行推進

---

## 10. 技術選択の最終決定事項

| 分野            | 技術                                  |
| ------------- | ----------------------------------- |
| **フロントエンド**   | Next.js + TypeScript + Tailwind CSS |
| **UIコンポーネント** | shadcn/ui                           |
| **バックエンド**    | Node.js (Express)                   |
| **AI実行**      | Python (Docker環境)                   |
| **データベース**    | **PlanetScale（MySQL互換）**            |
| **デプロイ**      | Vercel推奨、docker-compose対応           |
